{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/anandtalware/fake-news-classification-with-lstm?scriptVersionId=194776002\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"4f7da466","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2024-08-31T08:18:56.584709Z","iopub.status.busy":"2024-08-31T08:18:56.583756Z","iopub.status.idle":"2024-08-31T08:18:57.349228Z","shell.execute_reply":"2024-08-31T08:18:57.348248Z"},"papermill":{"duration":0.782972,"end_time":"2024-08-31T08:18:57.351463","exception":false,"start_time":"2024-08-31T08:18:56.568491","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["/kaggle/input/fake-news/submit.csv\n","/kaggle/input/fake-news/train.csv\n","/kaggle/input/fake-news/test.csv\n"]}],"source":["# This Python 3 environment comes with many helpful analytics libraries installed\n","# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n","# For example, here's several helpful packages to load\n","\n","import numpy as np # linear algebra\n","import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","import os\n","for dirname, _, filenames in os.walk('/kaggle/input'):\n","    for filename in filenames:\n","        print(os.path.join(dirname, filename))\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"markdown","id":"8fb1883c","metadata":{"papermill":{"duration":0.012742,"end_time":"2024-08-31T08:18:57.377531","exception":false,"start_time":"2024-08-31T08:18:57.364789","status":"completed"},"tags":[]},"source":["# Basic imports\n"]},{"cell_type":"code","execution_count":2,"id":"fd144672","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:18:57.405518Z","iopub.status.busy":"2024-08-31T08:18:57.405017Z","iopub.status.idle":"2024-08-31T08:18:58.398503Z","shell.execute_reply":"2024-08-31T08:18:58.397693Z"},"papermill":{"duration":1.010195,"end_time":"2024-08-31T08:18:58.400927","exception":false,"start_time":"2024-08-31T08:18:57.390732","status":"completed"},"tags":[]},"outputs":[],"source":["import sklearn"]},{"cell_type":"code","execution_count":3,"id":"cb3653c3","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:18:58.429322Z","iopub.status.busy":"2024-08-31T08:18:58.428793Z","iopub.status.idle":"2024-08-31T08:19:17.702783Z","shell.execute_reply":"2024-08-31T08:19:17.701692Z"},"papermill":{"duration":19.290941,"end_time":"2024-08-31T08:19:17.705284","exception":false,"start_time":"2024-08-31T08:18:58.414343","status":"completed"},"tags":[]},"outputs":[],"source":["import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import classification_report, confusion_matrix\n","\n","# tensorflow imports\n","import tensorflow as tf\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import Dense, Embedding, LSTM, Dropout\n","from tensorflow.keras.preprocessing.text import Tokenizer\n","from tensorflow.keras.preprocessing.sequence import pad_sequences\n","from tensorflow.keras.callbacks import EarlyStopping\n","'''\n","# nltk imports\n","import nltk\n","from nltk.tokenize import word_tokenize\n","from nltk.corpus import stopwords\n","# from nltk.stem import PorterStemmer\n","from nltk.stem import WordNetLemmatizer\n","from nltk import pos_tag\n","import string\n","\n","# Download necessary NLTK resources\n","nltk.download('punkt')\n","nltk.download('stopwords')\n","nltk.download('averaged_perceptron_tagger')\n","nltk.download('wordnet')'''\n","\n","# spacy imports\n","import spacy\n"]},{"cell_type":"markdown","id":"4c075a5a","metadata":{"papermill":{"duration":0.013096,"end_time":"2024-08-31T08:19:17.731768","exception":false,"start_time":"2024-08-31T08:19:17.718672","status":"completed"},"tags":[]},"source":["# Data importing"]},{"cell_type":"code","execution_count":4,"id":"9a6e940b","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:17.760538Z","iopub.status.busy":"2024-08-31T08:19:17.759394Z","iopub.status.idle":"2024-08-31T08:19:19.494814Z","shell.execute_reply":"2024-08-31T08:19:19.493918Z"},"papermill":{"duration":1.752172,"end_time":"2024-08-31T08:19:19.497112","exception":false,"start_time":"2024-08-31T08:19:17.74494","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>title</th>\n","      <th>author</th>\n","      <th>text</th>\n","      <th>label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>House Dem Aide: We Didnât Even See Comeyâs...</td>\n","      <td>Darrell Lucus</td>\n","      <td>House Dem Aide: We Didnât Even See Comeyâs...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>FLYNN: Hillary Clinton, Big Woman on Campus - ...</td>\n","      <td>Daniel J. Flynn</td>\n","      <td>Ever get the feeling your life circles the rou...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>Why the Truth Might Get You Fired</td>\n","      <td>Consortiumnews.com</td>\n","      <td>Why the Truth Might Get You Fired October 29, ...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>15 Civilians Killed In Single US Airstrike Hav...</td>\n","      <td>Jessica Purkiss</td>\n","      <td>Videos 15 Civilians Killed In Single US Airstr...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>Iranian woman jailed for fictional unpublished...</td>\n","      <td>Howard Portnoy</td>\n","      <td>Print \\nAn Iranian woman has been sentenced to...</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   id                                              title              author  \\\n","0   0  House Dem Aide: We Didnât Even See Comeyâs...       Darrell Lucus   \n","1   1  FLYNN: Hillary Clinton, Big Woman on Campus - ...     Daniel J. Flynn   \n","2   2                  Why the Truth Might Get You Fired  Consortiumnews.com   \n","3   3  15 Civilians Killed In Single US Airstrike Hav...     Jessica Purkiss   \n","4   4  Iranian woman jailed for fictional unpublished...      Howard Portnoy   \n","\n","                                                text  label  \n","0  House Dem Aide: We Didnât Even See Comeyâs...      1  \n","1  Ever get the feeling your life circles the rou...      0  \n","2  Why the Truth Might Get You Fired October 29, ...      1  \n","3  Videos 15 Civilians Killed In Single US Airstr...      1  \n","4  Print \\nAn Iranian woman has been sentenced to...      1  "]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["# train data\n","train = pd.read_csv('/kaggle/input/fake-news/train.csv', encoding='latin-1')\n","train.head()"]},{"cell_type":"code","execution_count":5,"id":"67e70c66","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:19.525525Z","iopub.status.busy":"2024-08-31T08:19:19.525127Z","iopub.status.idle":"2024-08-31T08:19:19.969254Z","shell.execute_reply":"2024-08-31T08:19:19.968262Z"},"papermill":{"duration":0.46094,"end_time":"2024-08-31T08:19:19.971677","exception":false,"start_time":"2024-08-31T08:19:19.510737","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>title</th>\n","      <th>author</th>\n","      <th>text</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>20800</td>\n","      <td>Specter of Trump Loosens Tongues, if Not Purse...</td>\n","      <td>David Streitfeld</td>\n","      <td>PALO ALTO, Calif.  â   After years of scorni...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>20801</td>\n","      <td>Russian warships ready to strike terrorists ne...</td>\n","      <td>NaN</td>\n","      <td>Russian warships ready to strike terrorists ne...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>20802</td>\n","      <td>#NoDAPL: Native American Leaders Vow to Stay A...</td>\n","      <td>Common Dreams</td>\n","      <td>Videos #NoDAPL: Native American Leaders Vow to...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>20803</td>\n","      <td>Tim Tebow Will Attempt Another Comeback, This ...</td>\n","      <td>Daniel Victor</td>\n","      <td>If at first you donât succeed, try a differe...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>20804</td>\n","      <td>Keiser Report: Meme Wars (E995)</td>\n","      <td>Truth Broadcast Network</td>\n","      <td>42 mins ago 1 Views 0 Comments 0 Likes 'For th...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["      id                                              title  \\\n","0  20800  Specter of Trump Loosens Tongues, if Not Purse...   \n","1  20801  Russian warships ready to strike terrorists ne...   \n","2  20802  #NoDAPL: Native American Leaders Vow to Stay A...   \n","3  20803  Tim Tebow Will Attempt Another Comeback, This ...   \n","4  20804                    Keiser Report: Meme Wars (E995)   \n","\n","                    author                                               text  \n","0         David Streitfeld  PALO ALTO, Calif.  â   After years of scorni...  \n","1                      NaN  Russian warships ready to strike terrorists ne...  \n","2            Common Dreams  Videos #NoDAPL: Native American Leaders Vow to...  \n","3            Daniel Victor  If at first you donât succeed, try a differe...  \n","4  Truth Broadcast Network  42 mins ago 1 Views 0 Comments 0 Likes 'For th...  "]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["# test data\n","test = pd.read_csv('/kaggle/input/fake-news/test.csv', encoding='latin-1')\n","test.head()"]},{"cell_type":"code","execution_count":6,"id":"ea1ffcd1","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.000987Z","iopub.status.busy":"2024-08-31T08:19:20.000601Z","iopub.status.idle":"2024-08-31T08:19:20.00573Z","shell.execute_reply":"2024-08-31T08:19:20.004865Z"},"papermill":{"duration":0.02236,"end_time":"2024-08-31T08:19:20.008112","exception":false,"start_time":"2024-08-31T08:19:19.985752","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Shape of Train data:  (20800, 5)\n","\n","Shape of Test data:  (5200, 4)\n"]}],"source":["# check shapes of both datasets\n","print('Shape of Train data: ', train.shape)\n","print()\n","print('Shape of Test data: ', test.shape)"]},{"cell_type":"markdown","id":"bec9ab8c","metadata":{"papermill":{"duration":0.013214,"end_time":"2024-08-31T08:19:20.034939","exception":false,"start_time":"2024-08-31T08:19:20.021725","status":"completed"},"tags":[]},"source":["# check data info for both data 'train and test\n"]},{"cell_type":"code","execution_count":7,"id":"1b996232","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.06323Z","iopub.status.busy":"2024-08-31T08:19:20.062853Z","iopub.status.idle":"2024-08-31T08:19:20.09046Z","shell.execute_reply":"2024-08-31T08:19:20.089429Z"},"papermill":{"duration":0.044293,"end_time":"2024-08-31T08:19:20.092642","exception":false,"start_time":"2024-08-31T08:19:20.048349","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 20800 entries, 0 to 20799\n","Data columns (total 5 columns):\n"," #   Column  Non-Null Count  Dtype \n","---  ------  --------------  ----- \n"," 0   id      20800 non-null  int64 \n"," 1   title   20242 non-null  object\n"," 2   author  18843 non-null  object\n"," 3   text    20761 non-null  object\n"," 4   label   20800 non-null  int64 \n","dtypes: int64(2), object(3)\n","memory usage: 812.6+ KB\n"]}],"source":["# train data info\n","train.info()"]},{"cell_type":"code","execution_count":8,"id":"93c74412","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.12149Z","iopub.status.busy":"2024-08-31T08:19:20.120706Z","iopub.status.idle":"2024-08-31T08:19:20.132203Z","shell.execute_reply":"2024-08-31T08:19:20.131183Z"},"papermill":{"duration":0.028091,"end_time":"2024-08-31T08:19:20.134266","exception":false,"start_time":"2024-08-31T08:19:20.106175","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 5200 entries, 0 to 5199\n","Data columns (total 4 columns):\n"," #   Column  Non-Null Count  Dtype \n","---  ------  --------------  ----- \n"," 0   id      5200 non-null   int64 \n"," 1   title   5078 non-null   object\n"," 2   author  4697 non-null   object\n"," 3   text    5193 non-null   object\n","dtypes: int64(1), object(3)\n","memory usage: 162.6+ KB\n"]}],"source":["# test data info \n","test.info()"]},{"cell_type":"markdown","id":"c36b6e10","metadata":{"execution":{"iopub.execute_input":"2024-08-31T05:55:56.543795Z","iopub.status.busy":"2024-08-31T05:55:56.54274Z","iopub.status.idle":"2024-08-31T05:55:56.548311Z","shell.execute_reply":"2024-08-31T05:55:56.546943Z","shell.execute_reply.started":"2024-08-31T05:55:56.54375Z"},"papermill":{"duration":0.013751,"end_time":"2024-08-31T08:19:20.161884","exception":false,"start_time":"2024-08-31T08:19:20.148133","status":"completed"},"tags":[]},"source":["# Data cleaning for both datasets train and test:"]},{"cell_type":"code","execution_count":9,"id":"4478e94b","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.191444Z","iopub.status.busy":"2024-08-31T08:19:20.190777Z","iopub.status.idle":"2024-08-31T08:19:20.206548Z","shell.execute_reply":"2024-08-31T08:19:20.205616Z"},"papermill":{"duration":0.032774,"end_time":"2024-08-31T08:19:20.208553","exception":false,"start_time":"2024-08-31T08:19:20.175779","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["id           0\n","title      558\n","author    1957\n","text        39\n","label        0\n","dtype: int64"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["# check null values\n","# train null values\n","train.isnull().sum()"]},{"cell_type":"code","execution_count":10,"id":"cadee0ae","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.23901Z","iopub.status.busy":"2024-08-31T08:19:20.23837Z","iopub.status.idle":"2024-08-31T08:19:20.248117Z","shell.execute_reply":"2024-08-31T08:19:20.247215Z"},"papermill":{"duration":0.026964,"end_time":"2024-08-31T08:19:20.250229","exception":false,"start_time":"2024-08-31T08:19:20.223265","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["id          0\n","title     122\n","author    503\n","text        7\n","dtype: int64"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["# null values in test data\n","test.isnull().sum()"]},{"cell_type":"code","execution_count":11,"id":"e25545db","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.281139Z","iopub.status.busy":"2024-08-31T08:19:20.280759Z","iopub.status.idle":"2024-08-31T08:19:20.2972Z","shell.execute_reply":"2024-08-31T08:19:20.296153Z"},"papermill":{"duration":0.033688,"end_time":"2024-08-31T08:19:20.299141","exception":false,"start_time":"2024-08-31T08:19:20.265453","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Total null values in train data:  2554\n","Total null values in test data:  632\n"]}],"source":["print('Total null values in train data: ',sum(train.isnull().sum()))\n","print('Total null values in test data: ',sum(test.isnull().sum()))"]},{"cell_type":"code","execution_count":12,"id":"b9003a83","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.329677Z","iopub.status.busy":"2024-08-31T08:19:20.328794Z","iopub.status.idle":"2024-08-31T08:19:20.42554Z","shell.execute_reply":"2024-08-31T08:19:20.424565Z"},"papermill":{"duration":0.114484,"end_time":"2024-08-31T08:19:20.427851","exception":false,"start_time":"2024-08-31T08:19:20.313367","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Total duplicated records in train data:  0\n","Total duplicated records in test data:  0\n"]}],"source":["# check duplicated data\n","print('Total duplicated records in train data: ',train.duplicated().sum() )\n","print('Total duplicated records in test data: ',test.duplicated().sum() )"]},{"cell_type":"markdown","id":"efcd828f","metadata":{"papermill":{"duration":0.017099,"end_time":"2024-08-31T08:19:20.460604","exception":false,"start_time":"2024-08-31T08:19:20.443505","status":"completed"},"tags":[]},"source":["## Conclusion after checking data\n","- There are total 2554 missing data in train data.\n","- There are total 632 missing data in test data.\n","- We can drop that null data from both dataset because we can't replace any other text values."]},{"cell_type":"code","execution_count":13,"id":"ad8c869f","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.491364Z","iopub.status.busy":"2024-08-31T08:19:20.49071Z","iopub.status.idle":"2024-08-31T08:19:20.510199Z","shell.execute_reply":"2024-08-31T08:19:20.509008Z"},"papermill":{"duration":0.037614,"end_time":"2024-08-31T08:19:20.512684","exception":false,"start_time":"2024-08-31T08:19:20.47507","status":"completed"},"tags":[]},"outputs":[],"source":["# drop na\n","train_1 = train.dropna()\n","test_1 = test.dropna()"]},{"cell_type":"code","execution_count":14,"id":"00d83e7e","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.543759Z","iopub.status.busy":"2024-08-31T08:19:20.542847Z","iopub.status.idle":"2024-08-31T08:19:20.548431Z","shell.execute_reply":"2024-08-31T08:19:20.54747Z"},"papermill":{"duration":0.02384,"end_time":"2024-08-31T08:19:20.550916","exception":false,"start_time":"2024-08-31T08:19:20.527076","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Shape of Train data after removed null values:  (18285, 5)\n","\n","Shape of Test data after removed null values:  (4575, 4)\n"]}],"source":["# shape after remove null values\n","print('Shape of Train data after removed null values: ', train_1.shape)\n","print()\n","print('Shape of Test data after removed null values: ', test_1.shape)"]},{"cell_type":"code","execution_count":15,"id":"00522b5e","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.583761Z","iopub.status.busy":"2024-08-31T08:19:20.583025Z","iopub.status.idle":"2024-08-31T08:19:20.589551Z","shell.execute_reply":"2024-08-31T08:19:20.588627Z"},"papermill":{"duration":0.024429,"end_time":"2024-08-31T08:19:20.591537","exception":false,"start_time":"2024-08-31T08:19:20.567108","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["Index(['id', 'title', 'author', 'text', 'label'], dtype='object')"]},"execution_count":15,"metadata":{},"output_type":"execute_result"}],"source":["train_1.columns"]},{"cell_type":"markdown","id":"f17d64a2","metadata":{"papermill":{"duration":0.016936,"end_time":"2024-08-31T08:19:20.625725","exception":false,"start_time":"2024-08-31T08:19:20.608789","status":"completed"},"tags":[]},"source":["# Preprocessing text:"]},{"cell_type":"code","execution_count":16,"id":"68c67cc9","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:20.669089Z","iopub.status.busy":"2024-08-31T08:19:20.668621Z","iopub.status.idle":"2024-08-31T08:19:21.93013Z","shell.execute_reply":"2024-08-31T08:19:21.929214Z"},"papermill":{"duration":1.287316,"end_time":"2024-08-31T08:19:21.932479","exception":false,"start_time":"2024-08-31T08:19:20.645163","status":"completed"},"tags":[]},"outputs":[],"source":["# Load spaCy model\n","nlp = spacy.load('en_core_web_sm')\n"]},{"cell_type":"code","execution_count":17,"id":"02ae4d81","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:21.963084Z","iopub.status.busy":"2024-08-31T08:19:21.962696Z","iopub.status.idle":"2024-08-31T08:19:21.969096Z","shell.execute_reply":"2024-08-31T08:19:21.968123Z"},"papermill":{"duration":0.024074,"end_time":"2024-08-31T08:19:21.971101","exception":false,"start_time":"2024-08-31T08:19:21.947027","status":"completed"},"tags":[]},"outputs":[],"source":["# create fuction that perform all preprocessing\n","\n","\n","def preprocess_text(text):\n","    \"\"\"Preprocess text using spaCy and prepare for TensorFlow tokenizer.\"\"\"\n","    if isinstance(text, str):  # Ensure input is a string\n","        doc = nlp(text)  # Process the text with spaCy\n","        tokens = [token.lemma_.lower() for token in doc if not token.is_punct and not token.is_stop]\n","        return ' '.join(tokens)  # Join tokens to form the cleaned text\n","    else:\n","        raise ValueError(\"Input must be a string\")"]},{"cell_type":"markdown","id":"f2f7dfd3","metadata":{"papermill":{"duration":0.014021,"end_time":"2024-08-31T08:19:21.999562","exception":false,"start_time":"2024-08-31T08:19:21.985541","status":"completed"},"tags":[]},"source":["# get dependent and independe data"]},{"cell_type":"code","execution_count":18,"id":"0d5f6d4b","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:22.029964Z","iopub.status.busy":"2024-08-31T08:19:22.02958Z","iopub.status.idle":"2024-08-31T08:19:22.034137Z","shell.execute_reply":"2024-08-31T08:19:22.033347Z"},"papermill":{"duration":0.021953,"end_time":"2024-08-31T08:19:22.036002","exception":false,"start_time":"2024-08-31T08:19:22.014049","status":"completed"},"tags":[]},"outputs":[],"source":["X = train_1['title']\n","y = train_1['label']"]},{"cell_type":"code","execution_count":19,"id":"c16a1212","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:22.066589Z","iopub.status.busy":"2024-08-31T08:19:22.066231Z","iopub.status.idle":"2024-08-31T08:19:22.074027Z","shell.execute_reply":"2024-08-31T08:19:22.073169Z"},"papermill":{"duration":0.025619,"end_time":"2024-08-31T08:19:22.075975","exception":false,"start_time":"2024-08-31T08:19:22.050356","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0        House Dem Aide: We Didnât Even See Comeyâs...\n","1        FLYNN: Hillary Clinton, Big Woman on Campus - ...\n","2                        Why the Truth Might Get You Fired\n","3        15 Civilians Killed In Single US Airstrike Hav...\n","4        Iranian woman jailed for fictional unpublished...\n","                               ...                        \n","20795    Rapper T.I.: Trump a âPoster Child For White...\n","20796    N.F.L. Playoffs: Schedule, Matchups and Odds -...\n","20797    Macyâs Is Said to Receive Takeover Approach ...\n","20798    NATO, Russia To Hold Parallel Exercises In Bal...\n","20799                            What Keeps the F-35 Alive\n","Name: title, Length: 18285, dtype: object"]},"execution_count":19,"metadata":{},"output_type":"execute_result"}],"source":["X\n"]},{"cell_type":"markdown","id":"8bff2d58","metadata":{"papermill":{"duration":0.014394,"end_time":"2024-08-31T08:19:22.104914","exception":false,"start_time":"2024-08-31T08:19:22.09052","status":"completed"},"tags":[]},"source":["# Train test split"]},{"cell_type":"code","execution_count":20,"id":"e5677113","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:19:22.136617Z","iopub.status.busy":"2024-08-31T08:19:22.135691Z","iopub.status.idle":"2024-08-31T08:21:26.943815Z","shell.execute_reply":"2024-08-31T08:21:26.942949Z"},"papermill":{"duration":124.826687,"end_time":"2024-08-31T08:21:26.946296","exception":false,"start_time":"2024-08-31T08:19:22.119609","status":"completed"},"tags":[]},"outputs":[],"source":["# Preprocess the texts by using above fuction\n","processed_texts = [preprocess_text(text) for text in X]"]},{"cell_type":"code","execution_count":21,"id":"d36beb40","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:26.977875Z","iopub.status.busy":"2024-08-31T08:21:26.977498Z","iopub.status.idle":"2024-08-31T08:21:26.991298Z","shell.execute_reply":"2024-08-31T08:21:26.99051Z"},"papermill":{"duration":0.032013,"end_time":"2024-08-31T08:21:26.993392","exception":false,"start_time":"2024-08-31T08:21:26.961379","status":"completed"},"tags":[]},"outputs":[],"source":["# Split the data into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(processed_texts, y, test_size=0.2, random_state=42)"]},{"cell_type":"code","execution_count":22,"id":"edcd210e","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:27.025825Z","iopub.status.busy":"2024-08-31T08:21:27.024462Z","iopub.status.idle":"2024-08-31T08:21:27.031456Z","shell.execute_reply":"2024-08-31T08:21:27.030384Z"},"papermill":{"duration":0.025473,"end_time":"2024-08-31T08:21:27.033597","exception":false,"start_time":"2024-08-31T08:21:27.008124","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Shape of X_train:  14628\n","Shape of X_test:  3657\n","Shape of y_train:  14628\n","Shape of y_test:  3657\n"]}],"source":["print('Shape of X_train: ',len(X_train))\n","print('Shape of X_test: ', len(X_test))\n","print('Shape of y_train: ', len(y_train))\n","print('Shape of y_test: ', len(y_test))"]},{"cell_type":"code","execution_count":23,"id":"ec8ed132","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:27.065391Z","iopub.status.busy":"2024-08-31T08:21:27.064519Z","iopub.status.idle":"2024-08-31T08:21:27.07209Z","shell.execute_reply":"2024-08-31T08:21:27.071108Z"},"papermill":{"duration":0.025781,"end_time":"2024-08-31T08:21:27.074168","exception":false,"start_time":"2024-08-31T08:21:27.048387","status":"completed"},"tags":[]},"outputs":[],"source":["# pad sequence\n","def prepare_and_pad_sequences(X_train, X_test, max_length=None):\n","    \"\"\"\n","    Tokenizes, converts texts to sequences, and pads the sequences for training and test sets.\n","\n","    Args:\n","    - X_train (list of str): List of training text records.\n","    - X_test (list of str): List of test text records.\n","    - max_length (int, optional): Maximum sequence length for padding. If None, it's determined from training data.\n","\n","    Returns:\n","    - X_train_padded (array): Padded sequences for training set.\n","    - X_test_padded (array): Padded sequences for test set.\n","    - tokenizer (Tokenizer): Fitted tokenizer for use with unseen data.\n","    \"\"\"\n","    \n","    # Initialize and fit the tokenizer on the training data\n","    tokenizer = Tokenizer()\n","    tokenizer.fit_on_texts(X_train)\n","    \n","    # Convert texts to sequences\n","    train_sequences = tokenizer.texts_to_sequences(X_train)\n","    test_sequences = tokenizer.texts_to_sequences(X_test)\n","    \n","    # Define the maximum sequence length\n","    if max_length is None:\n","        max_length = max(len(seq) for seq in train_sequences)# Or choose another method for max_length\n","        \n","    \n","    # Pad sequences\n","    X_train_padded = pad_sequences(train_sequences, maxlen=max_length+1)\n","    X_test_padded = pad_sequences(test_sequences, maxlen=max_length+1)\n","    \n","    return X_train_padded, X_test_padded, max_length, tokenizer"]},{"cell_type":"markdown","id":"194aec0e","metadata":{"papermill":{"duration":0.014382,"end_time":"2024-08-31T08:21:27.103269","exception":false,"start_time":"2024-08-31T08:21:27.088887","status":"completed"},"tags":[]},"source":[]},{"cell_type":"code","execution_count":24,"id":"82c94dce","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:27.134687Z","iopub.status.busy":"2024-08-31T08:21:27.134273Z","iopub.status.idle":"2024-08-31T08:21:27.8111Z","shell.execute_reply":"2024-08-31T08:21:27.810012Z"},"papermill":{"duration":0.69541,"end_time":"2024-08-31T08:21:27.81335","exception":false,"start_time":"2024-08-31T08:21:27.11794","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Training Sequences Shape: (14628, 44)\n","Testing Sequences Shape: (3657, 44)\n","Max length is :  44\n"]}],"source":["\n","# Prepare sequences for training and testing sets\n","X_train_padded, X_test_padded,max_length, tokenizer = prepare_and_pad_sequences(X_train, X_test)\n","\n","\n","print(\"Training Sequences Shape:\", X_train_padded.shape)\n","print(\"Testing Sequences Shape:\", X_test_padded.shape)\n","print('Max length is : ', max_length+1)\n","\n"]},{"cell_type":"code","execution_count":25,"id":"0cd5271e","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:27.84541Z","iopub.status.busy":"2024-08-31T08:21:27.844551Z","iopub.status.idle":"2024-08-31T08:21:27.851043Z","shell.execute_reply":"2024-08-31T08:21:27.850196Z"},"papermill":{"duration":0.024631,"end_time":"2024-08-31T08:21:27.853117","exception":false,"start_time":"2024-08-31T08:21:27.828486","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["array([[    0,     0,     0, ...,     1,     2,     3],\n","       [    0,     0,     0, ...,     1,     2,     3],\n","       [    0,     0,     0, ...,     1,     2,     3],\n","       ...,\n","       [    0,     0,     0, ...,     1,     2,     3],\n","       [    0,     0,     0, ...,  1523,  1629,     5],\n","       [    0,     0,     0, ...,   642,  2843, 21360]], dtype=int32)"]},"execution_count":25,"metadata":{},"output_type":"execute_result"}],"source":["X_train_padded"]},{"cell_type":"markdown","id":"5db0d6f4","metadata":{"papermill":{"duration":0.014681,"end_time":"2024-08-31T08:21:27.882985","exception":false,"start_time":"2024-08-31T08:21:27.868304","status":"completed"},"tags":[]},"source":["# Model creation"]},{"cell_type":"code","execution_count":26,"id":"51c1feaa","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:27.965104Z","iopub.status.busy":"2024-08-31T08:21:27.96417Z","iopub.status.idle":"2024-08-31T08:21:27.969605Z","shell.execute_reply":"2024-08-31T08:21:27.968721Z"},"papermill":{"duration":0.023896,"end_time":"2024-08-31T08:21:27.972025","exception":false,"start_time":"2024-08-31T08:21:27.948129","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["vocab size is :  21361\n"]}],"source":["# Model parameters\n","vocab_size = len(tokenizer.word_index) + 1  # Vocabulary size\n","print('vocab size is : ', vocab_size)\n","embedding_dim = 100  # Dimension of the embedding vector\n","#max_length = padded_sequences.shape[1]  # Length of the input sequences\n","max_length = max_length"]},{"cell_type":"code","execution_count":27,"id":"078a62b4","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:28.003967Z","iopub.status.busy":"2024-08-31T08:21:28.00315Z","iopub.status.idle":"2024-08-31T08:21:28.529932Z","shell.execute_reply":"2024-08-31T08:21:28.529109Z"},"papermill":{"duration":0.545176,"end_time":"2024-08-31T08:21:28.53221","exception":false,"start_time":"2024-08-31T08:21:27.987034","status":"completed"},"tags":[]},"outputs":[],"source":["# lstm model \n","# Build the model\n","model = Sequential([\n","    Embedding(input_dim=vocab_size, output_dim=embedding_dim),\n","    Dropout(0.3),\n","    LSTM(128, return_sequences=True),\n","    Dropout(0.5),\n","    LSTM(64),\n","    Dense(1, activation='sigmoid')  # For binary classification; use softmax for multi-class\n","])\n","\n","# Compile the model\n","model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])"]},{"cell_type":"code","execution_count":28,"id":"49c1109c","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:28.564378Z","iopub.status.busy":"2024-08-31T08:21:28.563457Z","iopub.status.idle":"2024-08-31T08:21:28.568474Z","shell.execute_reply":"2024-08-31T08:21:28.567545Z"},"papermill":{"duration":0.023207,"end_time":"2024-08-31T08:21:28.570454","exception":false,"start_time":"2024-08-31T08:21:28.547247","status":"completed"},"tags":[]},"outputs":[],"source":["# Initialize the early stopping callback\n","early_stopping = EarlyStopping(\n","    monitor='val_loss',  # Metric to monitor (e.g., 'val_accuracy', 'val_loss')\n","    patience=3,          # Number of epochs with no improvement after which training will be stopped\n","    verbose=1,           # Verbosity mode (0 or 1)\n","    restore_best_weights=True  # Restore model weights from the epoch with the best value of the monitored quantity\n",")"]},{"cell_type":"code","execution_count":29,"id":"7396ae9f","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:28.602449Z","iopub.status.busy":"2024-08-31T08:21:28.601831Z","iopub.status.idle":"2024-08-31T08:21:49.922124Z","shell.execute_reply":"2024-08-31T08:21:49.921098Z"},"papermill":{"duration":21.338901,"end_time":"2024-08-31T08:21:49.924435","exception":false,"start_time":"2024-08-31T08:21:28.585534","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch 1/10\n","\u001b[1m412/412\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m10s\u001b[0m 10ms/step - accuracy: 0.8310 - loss: 0.3405 - val_accuracy: 0.9385 - val_loss: 0.1540\n","Epoch 2/10\n","\u001b[1m412/412\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 9ms/step - accuracy: 0.9783 - loss: 0.0647 - val_accuracy: 0.9337 - val_loss: 0.1689\n","Epoch 3/10\n","\u001b[1m412/412\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 9ms/step - accuracy: 0.9938 - loss: 0.0227 - val_accuracy: 0.9357 - val_loss: 0.2626\n","Epoch 4/10\n","\u001b[1m412/412\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 9ms/step - accuracy: 0.9950 - loss: 0.0127 - val_accuracy: 0.9214 - val_loss: 0.2897\n","Epoch 4: early stopping\n","Restoring model weights from the end of the best epoch: 1.\n"]}],"source":["# Train the model\n","history = model.fit(X_train_padded, y_train, epochs=10, batch_size=32, \n","                    validation_split=0.1, verbose=1,\n","                   callbacks = [early_stopping])"]},{"cell_type":"code","execution_count":30,"id":"dd074c63","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:50.002481Z","iopub.status.busy":"2024-08-31T08:21:50.001801Z","iopub.status.idle":"2024-08-31T08:21:50.506Z","shell.execute_reply":"2024-08-31T08:21:50.504956Z"},"papermill":{"duration":0.545052,"end_time":"2024-08-31T08:21:50.507991","exception":false,"start_time":"2024-08-31T08:21:49.962939","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["\u001b[1m115/115\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 4ms/step - accuracy: 0.9283 - loss: 0.1761\n","Test Loss: 0.16828279197216034\n","Test Accuracy: 0.9319114089012146\n"]}],"source":["# Evaluate the model\n","loss, accuracy = model.evaluate(X_test_padded, y_test, verbose=1)\n","print(f\"Test Loss: {loss}\")\n","print(f\"Test Accuracy: {accuracy}\")"]},{"cell_type":"code","execution_count":31,"id":"5b8649b4","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:50.586573Z","iopub.status.busy":"2024-08-31T08:21:50.586166Z","iopub.status.idle":"2024-08-31T08:21:51.40357Z","shell.execute_reply":"2024-08-31T08:21:51.402706Z"},"papermill":{"duration":0.859414,"end_time":"2024-08-31T08:21:51.406012","exception":false,"start_time":"2024-08-31T08:21:50.546598","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["\u001b[1m115/115\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 4ms/step\n"]}],"source":["pred1 = model.predict(X_test_padded)\n","pred1 = [1 if i > 0.5 else 0 for i in pred1]"]},{"cell_type":"code","execution_count":32,"id":"d06d2788","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:51.48854Z","iopub.status.busy":"2024-08-31T08:21:51.487852Z","iopub.status.idle":"2024-08-31T08:21:51.496538Z","shell.execute_reply":"2024-08-31T08:21:51.495351Z"},"papermill":{"duration":0.051939,"end_time":"2024-08-31T08:21:51.498715","exception":false,"start_time":"2024-08-31T08:21:51.446776","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[[1894  188]\n"," [  61 1514]]\n"]}],"source":["# confusion matrix for \n","print(confusion_matrix(y_test, pred1))"]},{"cell_type":"code","execution_count":33,"id":"bbb680ae","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:51.580264Z","iopub.status.busy":"2024-08-31T08:21:51.579857Z","iopub.status.idle":"2024-08-31T08:21:51.588242Z","shell.execute_reply":"2024-08-31T08:21:51.587191Z"},"papermill":{"duration":0.050868,"end_time":"2024-08-31T08:21:51.590246","exception":false,"start_time":"2024-08-31T08:21:51.539378","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy:  0.9319114027891715\n"]}],"source":["# accyracy score\n","from sklearn.metrics import accuracy_score\n","print('Accuracy: ', accuracy_score(y_test, pred1))"]},{"cell_type":"code","execution_count":34,"id":"bb887064","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:51.672328Z","iopub.status.busy":"2024-08-31T08:21:51.671389Z","iopub.status.idle":"2024-08-31T08:21:51.689622Z","shell.execute_reply":"2024-08-31T08:21:51.688291Z"},"papermill":{"duration":0.061515,"end_time":"2024-08-31T08:21:51.691909","exception":false,"start_time":"2024-08-31T08:21:51.630394","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","           0       0.97      0.91      0.94      2082\n","           1       0.89      0.96      0.92      1575\n","\n","    accuracy                           0.93      3657\n","   macro avg       0.93      0.94      0.93      3657\n","weighted avg       0.93      0.93      0.93      3657\n","\n"]}],"source":["# classification report\n","print(classification_report(y_test, pred1))"]},{"cell_type":"markdown","id":"bbfeeba9","metadata":{"papermill":{"duration":0.039056,"end_time":"2024-08-31T08:21:51.770839","exception":false,"start_time":"2024-08-31T08:21:51.731783","status":"completed"},"tags":[]},"source":["# Prediction on New unseen data : test_1 data which we have already cleaned."]},{"cell_type":"code","execution_count":35,"id":"f2d039db","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:51.852251Z","iopub.status.busy":"2024-08-31T08:21:51.851218Z","iopub.status.idle":"2024-08-31T08:21:55.92657Z","shell.execute_reply":"2024-08-31T08:21:55.925521Z"},"papermill":{"duration":4.118545,"end_time":"2024-08-31T08:21:55.928979","exception":false,"start_time":"2024-08-31T08:21:51.810434","status":"completed"},"tags":[]},"outputs":[],"source":["# Predict on new data\n","sequences_text_1 = tokenizer.texts_to_sequences(test_1['text'])\n","pad_sequences_text_1 = pad_sequences(sequences_text_1, maxlen=max_length+1)\n"]},{"cell_type":"code","execution_count":36,"id":"0738d87c","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:56.011005Z","iopub.status.busy":"2024-08-31T08:21:56.010034Z","iopub.status.idle":"2024-08-31T08:21:56.016976Z","shell.execute_reply":"2024-08-31T08:21:56.016067Z"},"papermill":{"duration":0.050532,"end_time":"2024-08-31T08:21:56.019201","exception":false,"start_time":"2024-08-31T08:21:55.968669","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["array([[   88,  7435, 19808, ...,   663,  5815,   499],\n","       [  179,  8448,  3949, ...,   509,  1953,    37],\n","       [ 6739,   587,  7763, ...,  2558, 11491,  2104],\n","       ...,\n","       [ 4333,  7763,    85, ...,  3518, 12947,   499],\n","       [  111,  1050,  1593, ...,     9,   199,   513],\n","       [ 1052,  1476,  5043, ...,  4131,  7763, 17820]], dtype=int32)"]},"execution_count":36,"metadata":{},"output_type":"execute_result"}],"source":["pad_sequences_text_1"]},{"cell_type":"code","execution_count":37,"id":"52b375bd","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:56.099921Z","iopub.status.busy":"2024-08-31T08:21:56.099539Z","iopub.status.idle":"2024-08-31T08:21:56.640209Z","shell.execute_reply":"2024-08-31T08:21:56.63885Z"},"papermill":{"duration":0.583749,"end_time":"2024-08-31T08:21:56.642784","exception":false,"start_time":"2024-08-31T08:21:56.059035","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["\u001b[1m143/143\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 3ms/step\n"]}],"source":["# Predict on new data\n","predictions = model.predict(pad_sequences_text_1)"]},{"cell_type":"code","execution_count":38,"id":"59838fd6","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:56.724723Z","iopub.status.busy":"2024-08-31T08:21:56.724366Z","iopub.status.idle":"2024-08-31T08:21:56.741579Z","shell.execute_reply":"2024-08-31T08:21:56.740543Z"},"papermill":{"duration":0.060613,"end_time":"2024-08-31T08:21:56.743582","exception":false,"start_time":"2024-08-31T08:21:56.682969","status":"completed"},"tags":[]},"outputs":[],"source":["pred = [1 if i > 0.5 else 0 for i in predictions]"]},{"cell_type":"code","execution_count":39,"id":"8665dcb7","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:56.82788Z","iopub.status.busy":"2024-08-31T08:21:56.827503Z","iopub.status.idle":"2024-08-31T08:21:56.83827Z","shell.execute_reply":"2024-08-31T08:21:56.837428Z"},"papermill":{"duration":0.055307,"end_time":"2024-08-31T08:21:56.840504","exception":false,"start_time":"2024-08-31T08:21:56.785197","status":"completed"},"tags":[]},"outputs":[],"source":["submit  = pd.read_csv('/kaggle/input/fake-news/submit.csv', encoding='latin-1')"]},{"cell_type":"code","execution_count":40,"id":"9dca2a1e","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:56.924591Z","iopub.status.busy":"2024-08-31T08:21:56.924208Z","iopub.status.idle":"2024-08-31T08:21:56.932168Z","shell.execute_reply":"2024-08-31T08:21:56.931159Z"},"papermill":{"duration":0.051745,"end_time":"2024-08-31T08:21:56.934309","exception":false,"start_time":"2024-08-31T08:21:56.882564","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["id       0\n","label    0\n","dtype: int64"]},"execution_count":40,"metadata":{},"output_type":"execute_result"}],"source":["submit.isnull().sum()"]},{"cell_type":"markdown","id":"14583fe4","metadata":{"papermill":{"duration":0.040098,"end_time":"2024-08-31T08:21:57.015974","exception":false,"start_time":"2024-08-31T08:21:56.975876","status":"completed"},"tags":[]},"source":["# save the model "]},{"cell_type":"code","execution_count":41,"id":"8b245325","metadata":{"execution":{"iopub.execute_input":"2024-08-31T08:21:57.097799Z","iopub.status.busy":"2024-08-31T08:21:57.097427Z","iopub.status.idle":"2024-08-31T08:21:57.233724Z","shell.execute_reply":"2024-08-31T08:21:57.232941Z"},"papermill":{"duration":0.180219,"end_time":"2024-08-31T08:21:57.23604","exception":false,"start_time":"2024-08-31T08:21:57.055821","status":"completed"},"tags":[]},"outputs":[],"source":["model.save('fake_news_classification.keras')"]},{"cell_type":"code","execution_count":null,"id":"76687ca3","metadata":{"papermill":{"duration":0.039502,"end_time":"2024-08-31T08:21:57.316513","exception":false,"start_time":"2024-08-31T08:21:57.277011","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":109592,"sourceId":8317,"sourceType":"competition"}],"dockerImageVersionId":30761,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.14"},"papermill":{"default_parameters":{},"duration":186.854334,"end_time":"2024-08-31T08:22:00.525897","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2024-08-31T08:18:53.671563","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}